---
import BaseLayout from '../layouts/BaseLayout.astro';

const pageTitle = 'Contact';
---

<BaseLayout pageTitle={pageTitle}>
  <div class='contact-container'>
    
    <h1>Contact & Booking</h1>
    
    <form name='tommy-contact-form' method='POST' data-netlify='true' action='/thanks' class='contact-form'>

      <div class='form-group'>
        <label for='name'>Name<span class='asterisk'>*</span></label>
        <input type='text' id='name' name='name' required />
      </div>
      
      <div class='form-group'>
        <label for='email'>Email<span class='asterisk'>*</span></label>
        <input type='email' id='email' name='email' required />
      </div>

      <fieldset class='radio-group'>
        <legend>How can I help?</legend>
        <div class='radio-option'>
          <input type='radio' id='general' name='inquiry-type' value='Question / Message' checked>
          <label for='general'>Question / Message</label>
        </div>
        <div class='radio-option'>
          <input type='radio' id='booking' name='inquiry-type' value='Booking Inquiry'>
          <label for='booking'>Booking Inquiry</label>
        </div>
      </fieldset>

      <fieldset id='message-fields'>
        <div class='form-group'>
          <label for='message'>Question or Message<span class='asterisk'>*</span></label>
          <textarea id='message' name='message' rows='5' required></textarea>
        </div>
      </fieldset>     

      <fieldset id='booking-fields'>
        <div class='form-group'>
          <label for='event-date'>Date of Event<span class='asterisk'>*</span></label>
          <input type='date' id='event-date' name='event-date' required />
        </div>
        
        <div class='form-group'>
          <label for='event-type'>Type of Event<span class='asterisk'>*</span></label>
          <input type='text' id='event-type' name='event-type' required />
        </div>

        <div class='form-group'>
          <label for='location'>Venue / Location<span class='asterisk'>*</span></label>
          <input type='text' id='location' name='location' required />
        </div>

        <div class='form-group'>
          <label for='details'>Additional Details</label>
          <textarea id='details' name='details' rows='5'></textarea>
        </div>
      </fieldset>      

      <p class='hidden' style='display:none;'>
        <label>Donâ€™t fill this out if you're human: <input name='bot-field' /></label>
      </p>
      
      <button type='submit'>Send</button>
      
    </form>

  </div>
</BaseLayout>

<style>
  .contact-container {
    display: flex;
    flex-direction: column;
    align-items: center;
    width: 100%;
    padding-bottom: 100px;
  }

  h1 {
    font-family: 'Averia Serif Libre', serif;
    color: var(--color-accent-primary);
    font-size: 48px;
    margin-top: 60px;
    margin-bottom: 40px;
  }

  .contact-form {
    width: 100%;
    border: 1px solid var(--color-app-white);
    padding: 60px 80px;
    box-sizing: content-box;
    border-radius: 4px;
    max-width: 500px;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  .asterisk {
    color: var(--color-accent-primary);
    font-weight: bold;
  }

  .form-group {
    display: flex;
    flex-direction: column;
  }

  label {
    margin-bottom: 8px;
    font-size: 16px;
  }

  input,
  textarea,
  select {
    background-color: var(--color-app-white);
    border: none;
    padding: 12px;
    font-size: 16px;
    border-radius: 2px;
    font-family: inherit;
    color: #333;
  }

  input[type='date'] {
    position: relative;
    color: #aaa;
  }

  input[type='date']:focus,
  input[type='date']:valid {
    color: #333;
  }

  fieldset {
    border: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: column;
    gap: 20px;
  }

  #message-fields, #booking-fields {
    border-top: 1px solid rgba(255, 248, 225, 0.2);
    padding-top: 20px;
  }

  legend {
    padding: 0 10px;
    margin-left: -10px;
  }

  button[type='submit'] {
    background-color: var(--color-accent-secondary);
    color: #fff;
    border: 1px solid transparent;
    border-radius: 4px;
    padding: 12px 24px;
    font-size: 16px;
    font-weight: bold;
    text-decoration: none;
    cursor: pointer;
    align-self: center;
    margin-top: 20px;
    transition: all 0.2s ease-in-out;
  }

  button[type='submit']:hover {
    filter: brightness(110%);
  }

  button[type='submit']:disabled {
    background-color: #cccccc;
    color: #666666;
    filter: none;
    cursor: unset;
  }

  .radio-group {
    border: none;
    padding: 0;
    margin: 0;
    display: flex;
    flex-direction: row;
    gap: 10px;
  }

  .radio-group legend {
    padding: 0;
    margin: 0 0 8px 0;
  }

  .radio-option {
    display: flex;
    flex: 1;
  }

  .radio-option input[type='radio'] {
    position: absolute;
    opacity: 0;
    width: 0;
    height: 0;
  }

  .radio-option label {
    flex-grow: 1;
    text-align: center;
    display: inline-block;
    padding: 12px;
    border: 1px solid var(--color-accent-secondary);
    border-radius: 2px;
    cursor: pointer;
    transition: all var(--elastic-duration) var(--elastic-timing);
    margin-bottom: 0;
    color: var(--color-accent-secondary);
    background-color: transparent;
  }

  .radio-option input[type='radio']:checked + label {
    background-color: var(--color-accent-secondary);
    color: #fff;
  }
</style>

<script is:inline>

  const nameInput = document.getElementById('name');
  const emailInput = document.getElementById('email');

  const messageFields = document.getElementById('message-fields');
  const messageTextarea = document.getElementById('message');

  const bookingFields = document.getElementById('booking-fields');
  const eventDateInput = document.getElementById('event-date');
  const eventTypeInput = document.getElementById('event-type');
  const locationInput = document.getElementById('location');
  const detailsInput = document.getElementById('details');
  
  const inquiryRadios = document.querySelectorAll('input[name="inquiry-type"]');
  const submitButton = document.querySelector('button[type="submit"]');

  function toggleFieldSet() {
    
    const selectedValue = document.querySelector('input[name="inquiry-type"]:checked').value;
    
    if (selectedValue === 'Question / Message') {
      
      messageFields.style.display = 'flex';
      messageTextarea.disabled = false;

      bookingFields.style.display = 'none';
      eventDateInput.disabled = true;
      eventTypeInput.disabled = true;
      locationInput.disabled = true;
      detailsInput.disabled = true;
      
    } else {
      
      messageFields.style.display = 'none';
      messageTextarea.disabled = true;
      
      bookingFields.style.display = 'flex';
      eventDateInput.disabled = false;
      eventTypeInput.disabled = false;
      locationInput.disabled = false;
      detailsInput.disabled = false;

    }

    validateForm();

  }

  toggleFieldSet();

  inquiryRadios.forEach(radio => {
    radio.addEventListener('change', toggleFieldSet);
  });

  const inputsToValidate = [
    nameInput,
    emailInput,
    messageTextarea,
    eventDateInput,
    eventTypeInput,
    locationInput,
  ];
  inputsToValidate.forEach(input => {
    input.addEventListener('input', validateForm);
  });

  function validateForm() {

    const selectedValue = document.querySelector('input[name="inquiry-type"]:checked').value;
    
    let isFormValid = false;

    if (selectedValue === 'Question / Message') {

      isFormValid = nameInput.checkValidity()
        && emailInput.checkValidity()
        && messageTextarea.checkValidity();

    } else {

      isFormValid = nameInput.checkValidity()
        && emailInput.checkValidity()
        && eventDateInput.checkValidity()
        && eventTypeInput.checkValidity()
        && locationInput.checkValidity();

    }

    submitButton.disabled = !isFormValid;
  }

</script>